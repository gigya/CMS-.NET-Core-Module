var gigyaCms={responseCodes:{Error:0,Success:1,AlreadyLoggedIn:2},authenticated:!1,baseUrl:"/api/gigya/account/",debugMode:!1,log:function(n,t){gigyaCms.debugMode&&window.console&&(t?console.log(n,t):console.log(n))},handleError:function(n){n?alert(n):alert(gigyaCms.genericErrorMessage)},redirectAfterLogin:function(n){gigyaCms.loggedInInRedirectUrl!=""&&(n=gigyaCms.loggedInInRedirectUrl);n&&n.length>0?window.location=n:window.location.reload()},redirectAfterEditProfile:function(){},redirectAfterLogout:function(n){gigyaCms.logoutRedirectUrl!=""&&(n=gigyaCms.logoutRedirectUrl);n&&n.length>0?window.location=n:window.location.reload()},genericErrorMessage:"",siteId:"",loggedInInRedirectUrl:"",logoutRedirectUrl:"",screenSetSettings:{login:{screenSet:"Default-RegistrationLogin"},register:{screenSet:"Default-RegistrationLogin",mobileScreenSet:"DefaultMobile-RegistrationLogin",startScreen:"gigya-register-screen"},editProfile:{screenSet:"Default-ProfileUpdate",mobileScreenSet:"DefaultMobile-ProfileUpdate",onAfterSubmit:function(n){gigyaCms.onProfileUpdated(n)}}},initGetAccountInfo:function(){gigya.accounts.getAccountInfo({callback:gigyaCms.onGetAccountInfo})},init:function(){gigyaCms.genericErrorMessage=jQuery("#gigya-error-message").val();gigyaCms.siteId=jQuery("#gigya-site-id").val();gigyaCms.loggedInInRedirectUrl=jQuery("#gigya-redirect-url").val();gigyaCms.logoutRedirectUrl=jQuery("#gigya-logout-url").val();gigyaCms.debugMode=window.gigyaDebugMode;window.gigyaBaseUrl&&(gigyaCms.baseUrl=window.gigyaBaseUrl);jQuery("#gigya-login").click(function(){return gigya.accounts.showScreenSet(gigyaCms.screenSetSettings.login),!1});jQuery("#gigya-logout").click(function(){return gigya.accounts.logout(),!1});jQuery("#gigya-register").click(function(){return gigya.accounts.showScreenSet(gigyaCms.screenSetSettings.register),!1});jQuery("#gigya-edit-profile").click(function(){return gigya.accounts.showScreenSet(gigyaCms.screenSetSettings.editProfile),!1});gigya.accounts.addEventHandlers({onLogin:gigyaCms.onLogin,onLogout:gigyaCms.onLogout})},onGetAccountInfo:function(n){gigyaCms.log("onGetAccountInfo",n);n.errorCode==0?gigyaCms.login(n,!1):gigyaCms.logout(!1)},onProfileUpdated:function(n){if(gigyaCms.log("onProfileUpdated",n),n.response&&n.response.UID){var t={UserId:n.response.UID,Signature:n.response.UIDSignature,SignatureTimestamp:n.response.signatureTimestamp,SiteId:gigyaCms.siteId};jQuery.ajax({type:"POST",url:gigyaCms.baseUrl+"editprofile",data:t,success:function(n){n!=null&&n.status==gigyaCms.responseCodes.Success?gigyaCms.redirectAfterEditProfile(n.redirectUrl):gigyaCms.handleError(n.errorMessage)},error:function(){gigyaCms.handleError()}})}},onLogin:function(n){gigyaCms.log("onLogin",n);gigyaCms.login(n,!0)},loggingIn:!1,login:function(n,t){if(!gigyaCms.loggingIn){gigyaCms.loggingIn=!0;var i={UserId:n.UID,Signature:n.UIDSignature,SignatureTimestamp:n.signatureTimestamp,SiteId:gigyaCms.siteId};jQuery.ajax({type:"POST",url:gigyaCms.baseUrl+"login",data:i,success:function(n){if(gigyaCms.loggingIn=!1,n!=null)switch(n.status){case gigyaCms.responseCodes.AlreadyLoggedIn:return;case gigyaCms.responseCodes.Success:t&&gigyaCms.redirectAfterLogin(n.redirectUrl);return;case gigyaCms.responseCodes.Error:gigyaCms.log("logout");gigya.accounts.logout();gigyaCms.handleError(n.errorMessage);return}else gigyaCms.log("logout"),gigya.accounts.logout(),gigyaCms.handleError(n.errorMessage)},error:function(n){gigyaCms.loggingIn=!1;gigyaCms.log("logout");gigya.accounts.logout();n.status===500&&gigyaCms.handleError()}})}},onLogout:function(){gigyaCms.log("onLogout");gigyaCms.logout(!0)},logout:function(n){var t={SiteId:gigyaCms.siteId};jQuery.ajax({type:"POST",url:gigyaCms.baseUrl+"logout",data:t,success:function(t){t!=null&&t.status==gigyaCms.responseCodes.Success?n&&gigyaCms.redirectAfterLogout(t.redirectUrl):gigyaCms.handleError(t.errorMessage)},error:function(n){n.status===500&&gigyaCms.handleError()}})}};gigyaCms.initGetAccountInfo();