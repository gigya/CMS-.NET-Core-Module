var gigyaSitefinity={responseCodes:{Error:0,Success:1,AlreadyLoggedIn:2},authenticated:!1,baseUrl:"/api/gigya/account/",debugMode:!1,log:function(n,t){gigyaSitefinity.debugMode&&window.console&&(t?console.log(n,t):console.log(n))},handleError:function(n){n?alert(n):alert(gigyaSitefinity.genericErrorMessage)},redirectAfterLogin:function(n){gigyaSitefinity.loggedInInRedirectUrl!=""&&(n=gigyaSitefinity.loggedInInRedirectUrl);n&&n.length>0?window.location=n:window.location.reload()},redirectAfterEditProfile:function(){},redirectAfterLogout:function(n){gigyaSitefinity.logoutRedirectUrl!=""&&(n=gigyaSitefinity.logoutRedirectUrl);n&&n.length>0?window.location=n:window.location.reload()},genericErrorMessage:"",siteId:"",loggedInInRedirectUrl:"",logoutRedirectUrl:"",screenSetSettings:{login:{screenSet:"Default-RegistrationLogin"},register:{screenSet:"Default-RegistrationLogin",mobileScreenSet:"DefaultMobile-RegistrationLogin",startScreen:"gigya-register-screen"},editProfile:{screenSet:"Default-ProfileUpdate",mobileScreenSet:"DefaultMobile-ProfileUpdate",onAfterSubmit:function(n){gigyaSitefinity.onProfileUpdated(n)}}},initGetAccountInfo:function(){gigya.accounts.getAccountInfo({callback:gigyaSitefinity.onGetAccountInfo})},init:function(){gigyaSitefinity.genericErrorMessage=jQuery("#gigya-error-message").val();gigyaSitefinity.siteId=jQuery("#gigya-site-id").val();gigyaSitefinity.loggedInInRedirectUrl=jQuery("#gigya-redirect-url").val();gigyaSitefinity.logoutRedirectUrl=jQuery("#gigya-logout-url").val();gigyaSitefinity.debugMode=window.gigyaDebugMode;window.gigyaBaseUrl&&(gigyaSitefinity.baseUrl=window.gigyaBaseUrl);jQuery("#gigya-login").click(function(){return gigya.accounts.showScreenSet(gigyaSitefinity.screenSetSettings.login),!1});jQuery("#gigya-logout").click(function(){return gigya.accounts.logout(),!1});jQuery("#gigya-register").click(function(){return gigya.accounts.showScreenSet(gigyaSitefinity.screenSetSettings.register),!1});jQuery("#gigya-edit-profile").click(function(){return gigya.accounts.showScreenSet(gigyaSitefinity.screenSetSettings.editProfile),!1});gigya.accounts.addEventHandlers({onLogin:gigyaSitefinity.onLogin,onLogout:gigyaSitefinity.onLogout})},onGetAccountInfo:function(n){gigyaSitefinity.log("onGetAccountInfo",n);n.errorCode==0?gigyaSitefinity.login(n,!1):gigyaSitefinity.logout(!1)},onProfileUpdated:function(n){if(gigyaSitefinity.log("onProfileUpdated",n),n.response&&n.response.UID){var t={UserId:n.response.UID,Signature:n.response.UIDSignature,SignatureTimestamp:n.response.signatureTimestamp,SiteId:gigyaSitefinity.siteId};jQuery.ajax({type:"POST",url:gigyaSitefinity.baseUrl+"editprofile",data:t,success:function(n){n!=null&&n.status==gigyaSitefinity.responseCodes.Success?gigyaSitefinity.redirectAfterEditProfile(n.redirectUrl):gigyaSitefinity.handleError(n.errorMessage)},error:function(){gigyaSitefinity.handleError()}})}},onLogin:function(n){gigyaSitefinity.log("onLogin",n);gigyaSitefinity.login(n,!0)},loggingIn:!1,login:function(n,t){if(!gigyaSitefinity.loggingIn){gigyaSitefinity.loggingIn=!0;var i={UserId:n.UID,Signature:n.UIDSignature,SignatureTimestamp:n.signatureTimestamp,SiteId:gigyaSitefinity.siteId};jQuery.ajax({type:"POST",url:gigyaSitefinity.baseUrl+"login",data:i,success:function(n){if(gigyaSitefinity.loggingIn=!1,n!=null)switch(n.status){case gigyaSitefinity.responseCodes.AlreadyLoggedIn:return;case gigyaSitefinity.responseCodes.Success:t&&gigyaSitefinity.redirectAfterLogin(n.redirectUrl);return;case gigyaSitefinity.responseCodes.Error:gigyaSitefinity.log("logout");gigya.accounts.logout();gigyaSitefinity.handleError(n.errorMessage);return}else gigyaSitefinity.log("logout"),gigya.accounts.logout(),gigyaSitefinity.handleError(n.errorMessage)},error:function(n){gigyaSitefinity.loggingIn=!1;gigyaSitefinity.log("logout");gigya.accounts.logout();n.status===500&&gigyaSitefinity.handleError()}})}},onLogout:function(){gigyaSitefinity.log("onLogout");gigyaSitefinity.logout(!0)},logout:function(n){var t={SiteId:gigyaSitefinity.siteId};jQuery.ajax({type:"POST",url:gigyaSitefinity.baseUrl+"logout",data:t,success:function(t){t!=null&&t.status==gigyaSitefinity.responseCodes.Success?n&&gigyaSitefinity.redirectAfterLogout(t.redirectUrl):gigyaSitefinity.handleError(t.errorMessage)},error:function(n){n.status===500&&gigyaSitefinity.handleError()}})}};gigyaSitefinity.initGetAccountInfo();